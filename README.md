# Qwen API è½¬ OpenAI æ ‡å‡†ä»£ç†

æœ¬é¡¹ç›®æä¾›äº†ä¸€ä¸ªè½»é‡çº§çš„å•æ–‡ä»¶ä»£ç†æœåŠ¡å™¨ï¼Œè®¾è®¡ä¸ºè¿è¡Œåœ¨ Deno ä¸Šã€‚å®ƒå°†æ ‡å‡†çš„ OpenAI API è¯·æ±‚è½¬æ¢ä¸º `chat.qwen.ai` ä½¿ç”¨çš„ä¸“æœ‰æ ¼å¼ï¼Œå¹¶å°†å“åº”è½¬æ¢å›æ ‡å‡†çš„ OpenAI æ ¼å¼ã€‚

è¿™ä½¿å¾—æ‚¨å¯ä»¥ä½¿ç”¨ OpenAI å…¼å®¹çš„å®¢æˆ·ç«¯ä¸ Qwenï¼ˆé€šä¹‰åƒé—®ï¼‰èŠå¤©æœåŠ¡è¿›è¡Œäº¤äº’ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

*   **OpenAI å…¼å®¹æ€§ï¼š** ä½œä¸º OpenAI API åŸºç¡€ URL çš„ç›´æ¥æ›¿ä»£å“ã€‚
*   **è¯·æ±‚è½¬æ¢ï¼š** å°† OpenAI èŠå¤©å®Œæˆè¯·æ±‚è½¬æ¢ä¸º Qwen æ ¼å¼ã€‚
*   **æµå¼è½¬æ¢ï¼š** å®æ—¶å°† Qwen çš„æœåŠ¡å™¨å‘é€äº‹ä»¶ï¼ˆSSEï¼‰æµè½¬æ¢ä¸º OpenAI æ ¼å¼ã€‚
*   **æ¨¡å‹å˜ä½“ï¼š** åŸºäºä¸Šæ¸¸æ¨¡å‹èƒ½åŠ›è‡ªåŠ¨åˆ›å»ºç‰¹æ®Šæ¨¡å‹å˜ä½“ï¼Œå¦‚ `qwen-max-thinking` å’Œ `qwen-max-search`ã€‚
*   **ä»¤ç‰Œè½®æ¢ï¼š** æ”¯æŒå¤šä¸ªä¸Šæ¸¸ `API_KEY` å¹¶åœ¨æ¯ä¸ªè¯·æ±‚ä¸­è½®æ¢ä½¿ç”¨ã€‚
*   **èº«ä»½éªŒè¯ï¼š** ä½¿ç”¨ `OPENAI_API_KEY` ä¿æŠ¤æ‚¨çš„ä»£ç†ç«¯ç‚¹ã€‚
*   **é›¶ä¾èµ–ï¼ˆDenoï¼‰ï¼š** ä½œä¸ºå•ä¸ªè„šæœ¬åœ¨ Deno Deploy æˆ–æœ¬åœ°è¿è¡Œï¼Œæ— éœ€ `npm install`ã€‚
*   **å¤šæ¨¡æ€æ”¯æŒï¼š** æ”¯æŒå›¾åƒä¸Šä¼ å’Œå¤„ç†ï¼Œè‡ªåŠ¨å°† base64 å›¾åƒä¸Šä¼ åˆ° Qwen çš„ OSS å­˜å‚¨ã€‚

## ğŸš€ éƒ¨ç½²ï¼ˆDeno Deployï¼‰

1.  **åˆ›å»º Deno Deploy é¡¹ç›®**ï¼š
    *   å‰å¾€ [Deno Deploy](https://deno.com/deploy) å¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ "Playground" é¡¹ç›®ã€‚
    *   å¤åˆ¶ `main.ts` çš„å…¨éƒ¨å†…å®¹å¹¶ç²˜è´´åˆ°ç¼–è¾‘å™¨ä¸­ã€‚

2.  **è®¾ç½®ç¯å¢ƒå˜é‡**ï¼š
    åœ¨æ‚¨çš„ Deno Deploy é¡¹ç›®çš„ "Settings" > "Environment Variables" éƒ¨åˆ†ï¼Œæ·»åŠ ä»¥ä¸‹å˜é‡ï¼š

    *   `OPENAI_API_KEY`ï¼šï¼ˆæ¨èï¼‰å®¢æˆ·ç«¯è®¿é—®æ­¤ä»£ç†çš„å¯†é’¥ã€‚ï¼ˆä¾‹å¦‚ï¼š`sk-my-secret-key-12345`ï¼‰
    *   `API_KEY`ï¼šæ‚¨çš„ Qwen è´¦æˆ·ä»¤ç‰Œã€‚å¯ä»¥æä¾›å¤šä¸ªä»¤ç‰Œï¼Œç”¨é€—å·åˆ†éš”è¿›è¡Œè½®æ¢ã€‚ï¼ˆä¾‹å¦‚ï¼š`ey...abc,ey...def`ï¼‰
    *   `SSXMOD_ITNA`ï¼šä¸Šæ¸¸ API æ‰€éœ€çš„ç‰¹æ®Š cookie å€¼ã€‚

3.  **è¿è¡Œ**ï¼š
    è„šæœ¬å°†è‡ªåŠ¨éƒ¨ç½²å’Œè¿è¡Œã€‚Deno Deploy ä¼šæä¾›æ‚¨çš„ç«¯ç‚¹ URLã€‚

## ğŸ’» æœ¬åœ°ä½¿ç”¨

1.  **ä¿å­˜æ–‡ä»¶** ä¸º `main.ts`ã€‚

2.  **åœ¨ç»ˆç«¯ä¸­è®¾ç½®ç¯å¢ƒå˜é‡**ï¼š
    ```sh
    export OPENAI_API_KEY="your_secret_proxy_key"
    export API_KEY="your_qwen_token"
    export SSXMOD_ITNA="your_cookie_value"
    ```

3.  **è¿è¡Œè„šæœ¬**ï¼š
    ```sh
    deno run --allow-net --allow-env main.ts
    ```
    æœåŠ¡å™¨å°†åœ¨ `http://localhost:8000` å¯åŠ¨ã€‚

## âš™ï¸ é…ç½®

æœåŠ¡å™¨é€šè¿‡ä»¥ä¸‹ç¯å¢ƒå˜é‡è¿›è¡Œé…ç½®ï¼š

| å˜é‡å             | æè¿°                                                         | å¿…éœ€     | ç¤ºä¾‹                                   |
| ----------------- | ----------------------------------------------------------- | -------- | -------------------------------------- |
| `OPENAI_API_KEY`  | ä¿æŠ¤ä»£ç†ç«¯ç‚¹çš„å¯†é’¥ Bearer ä»¤ç‰Œã€‚å¦‚æœæœªè®¾ç½®ï¼Œä»£ç†å°†å¯¹å…¬ä¼—å¼€æ”¾ã€‚        | å¦       | `sk-my-secret-key-12345`              |
| `API_KEY`         | æ‚¨çš„ Qwen è´¦æˆ·ä»¤ç‰Œç”¨äºä¸Šæ¸¸ APIã€‚å¤šä¸ªå¯†é’¥ç”¨é€—å·åˆ†éš”ä»¥å®ç°è½®æ¢ã€‚        | æ˜¯       | `ey...abc,ey...def`                   |
| `SSXMOD_ITNA`     | `chat.qwen.ai` æ‰€éœ€çš„ `ssxmod_itna` cookie å€¼ã€‚               | æ˜¯       | `mqUxRDBD...DYAEDBYD74G+DDeDixGm...` |

## ğŸ”Œ API ç«¯ç‚¹

*   `GET /v1/models`
    *   æ£€ç´¢å¯ç”¨ Qwen æ¨¡å‹åˆ—è¡¨ï¼ŒåŒ…æ‹¬ç‰¹æ®Šå˜ä½“å¦‚ `-thinking`ã€`-search` å’Œ `-image`ã€‚
*   `POST /v1/chat/completions`
    *   èŠå¤©çš„ä¸»è¦ç«¯ç‚¹ã€‚æ¥å—æ ‡å‡†çš„ OpenAI èŠå¤©å®Œæˆè¯·æ±‚å¹¶æ”¯æŒæµå¼å“åº”ã€‚

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

ä¸€æ—¦éƒ¨ç½²å®Œæˆï¼Œæ‚¨å¯ä»¥åƒä½¿ç”¨ OpenAI API ä¸€æ ·ä½¿ç”¨è¯¥ä»£ç†ï¼š

```bash
curl -X POST http://your-deno-deploy-url/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer your-openai-api-key" \
  -d '{
    "model": "qwen-max",
    "messages": [
      {
        "role": "user",
        "content": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±ã€‚"
      }
    ],
    "stream": true
  }'
```

### å¤šæ¨¡æ€ç¤ºä¾‹ï¼ˆå›¾åƒå¤„ç†ï¼‰

```bash
curl -X POST http://your-deno-deploy-url/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer your-openai-api-key" \
  -d '{
    "model": "qwen-vl-max",
    "messages": [
      {
        "role": "user",
        "content": [
          {
            "type": "text",
            "text": "è¿™å¼ å›¾ç‰‡é‡Œæœ‰ä»€ä¹ˆï¼Ÿ"
          },
          {
            "type": "image_url",
            "image_url": {
              "url": "data:image/jpeg;base64,/9j/4AAQSkZJRgABA..."
            }
          }
        ]
      }
    ]
  }'
```

## ğŸ”‘ å¦‚ä½•è·å–å¿…è¦çš„ä»¤ç‰Œ

### è·å– API_KEYï¼ˆQwen ä»¤ç‰Œï¼‰

1. è®¿é—® [chat.qwen.ai](https://chat.qwen.ai)
2. ç™»å½•æ‚¨çš„è´¦æˆ·
3. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
4. è½¬åˆ° Networkï¼ˆç½‘ç»œï¼‰æ ‡ç­¾
5. å‘é€ä¸€æ¡æ¶ˆæ¯
6. åœ¨ç½‘ç»œè¯·æ±‚ä¸­æŸ¥æ‰¾ `Authorization` å¤´éƒ¨ï¼Œå¤åˆ¶ `Bearer` åé¢çš„ä»¤ç‰Œ

### è·å– SSXMOD_ITNAï¼ˆCookie å€¼ï¼‰

1. åœ¨åŒä¸€ä¸ªæµè§ˆå™¨ä¼šè¯ä¸­
2. è½¬åˆ° Applicationï¼ˆåº”ç”¨ï¼‰æ ‡ç­¾
3. åœ¨ Cookies éƒ¨åˆ†æ‰¾åˆ° `chat.qwen.ai`
4. å¤åˆ¶ `ssxmod_itna` çš„å€¼

## ğŸ¯ æ”¯æŒçš„æ¨¡å‹å˜ä½“

è¯¥ä»£ç†æ”¯æŒä»¥ä¸‹æ¨¡å‹å˜ä½“ï¼š

*   `qwen-max` - æ ‡å‡†æ¨¡å‹
*   `qwen-max-thinking` - å¯ç”¨æ€è€ƒæ¨¡å¼
*   `qwen-max-search` - å¯ç”¨æœç´¢åŠŸèƒ½
*   `qwen-vl-max-image` - å›¾åƒç”Ÿæˆæ¨¡å¼
*   `qwen-vl-max-video` - è§†é¢‘ç”Ÿæˆæ¨¡å¼

## ğŸ› ï¸ æŠ€æœ¯å®ç°

è¯¥é¡¹ç›®åŸºäºä»¥ä¸‹æŠ€æœ¯ï¼š

*   **Deno** - ç°ä»£åŒ–çš„ JavaScript/TypeScript è¿è¡Œæ—¶
*   **Oak** - Deno çš„ HTTP ä¸­é—´ä»¶æ¡†æ¶
*   **S3 Lite Client** - ç”¨äºæ–‡ä»¶ä¸Šä¼ åˆ°é˜¿é‡Œäº‘ OSS
*   **Server-Sent Events (SSE)** - å®æ—¶æµå¼å“åº”

### æ ¸å¿ƒåŠŸèƒ½

1. **è¯·æ±‚è½¬æ¢**ï¼šå°† OpenAI æ ¼å¼çš„è¯·æ±‚è½¬æ¢ä¸º Qwen API æ ¼å¼
2. **å“åº”è½¬æ¢**ï¼šå°† Qwen çš„ SSE æµè½¬æ¢å› OpenAI æ ¼å¼
3. **å›¾åƒå¤„ç†**ï¼šè‡ªåŠ¨ä¸Šä¼  base64 å›¾åƒåˆ° Qwen çš„ OSS å­˜å‚¨
4. **ä»¤ç‰Œç®¡ç†**ï¼šæ”¯æŒå¤šä¸ª API å¯†é’¥çš„è½®æ¢ä½¿ç”¨
5. **é”™è¯¯å¤„ç†**ï¼šå®Œæ•´çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

## ğŸš¨ æ³¨æ„äº‹é¡¹

*   ç¡®ä¿æ‚¨çš„ Qwen è´¦æˆ·æœ‰è¶³å¤Ÿçš„é…é¢
*   `SSXMOD_ITNA` cookie å¯èƒ½ä¼šå®šæœŸè¿‡æœŸï¼Œéœ€è¦æ›´æ–°
*   å»ºè®®è®¾ç½®å¤šä¸ª `API_KEY` ä»¥æé«˜å¯ç”¨æ€§
*   ä»£ç†æœåŠ¡å™¨ä¼šè®°å½•è¯·æ±‚æ—¥å¿—ï¼Œè¯·æ³¨æ„éšç§

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäºåŸå§‹ [qwenchat2api](https://github.com/highkay/qwenchat2api) é¡¹ç›®å¼€å‘ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---

**å…è´£å£°æ˜**ï¼šæœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ç”¨é€”ã€‚è¯·éµå®ˆç›¸å…³æœåŠ¡çš„ä½¿ç”¨æ¡æ¬¾ã€‚
